<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="User Profile - JOSAA College Preference List Generator">
    <title>My Profile - JOSAA Preference Generator</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="./static/favicon.ico">
    
    <!-- CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="./static/css/main.css" rel="stylesheet">

    <!-- Hash Tracker for Debugging -->
    <script src="./static/js/hash-tracker.js" defer></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-firestore-compat.js"></script>
    
    <!-- Profile-specific styles -->
    <style>
        .profile-card {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px rgba(212, 175, 55, 0.3);
        }
        
        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--secondary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-color);
            margin: 0 auto 1rem;
        }
        
        .stats-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.15);
            border: 1px solid rgba(212, 175, 55, 0.1);
            transition: transform 0.3s ease;
        }
        
        .stats-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-icon {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .account-badge {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: bold;
            margin-top: 0.5rem;
        }
        
        .unlimited-account {
            background: linear-gradient(45deg, #d1e7dd, #a3d9a4);
            color: #0f5132;
        }
        
        .limited-account {
            background: linear-gradient(45deg, #fff3cd, #ffeaa7);
            color: #664d03;
        }
        
        .usage-history {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .usage-day {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .usage-day:last-child {
            border-bottom: none;
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1050;
        }

        .auth-error {
            display: none;
            font-family: 'Poppins', sans-serif;
            max-width: 500px;
            margin: 100px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            text-align: center;
        }
        .auth-error h2 {
            color: #e53935;
            margin-bottom: 20px;
        }
        .auth-error a {
            color: #1e88e5;
            text-decoration: none;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div id="auth-loading" class="loading-overlay">
        <div class="d-flex flex-column align-items-center">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2">Loading profile...</p>
        </div>
    </div>

    <!-- Error Alert Container -->
    <div id="error-alert-container" style="position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 1060; width: 90%; max-width: 600px;"></div>

    <!-- Authentication error container -->
    <div id="auth-error-container" class="auth-error" style="display: none;"></div>

    <!-- Main Content Container -->
    <div id="main-content" style="display: none;">
        <div class="container py-4">
            <!-- Navigation -->
            <nav class="bg-white shadow-md mb-4">
                <div class="container px-4">
                    <div class="flex items-center justify-between h-16">
                        <div class="d-flex align-items-center">
                            <a href="https://nextstepedu.co.in" class="d-flex align-items-center text-decoration-none">
                                <img src="./static/nextstep_logo.jpeg" alt="Logo" class="h-8" style="height: 32px; width: auto;">
                                <span class="ms-2 fw-bold fs-4">NextStep</span>
                            </a>
                        </div>
                        <div class="d-flex align-items-center gap-3">
                            <a href="./index.html" class="btn btn-outline-primary">
                                <i class="fas fa-arrow-left"></i> Back to Generator
                            </a>
                        </div>
                    </div>
                </div>
            </nav>

            <!-- Profile Header -->
            <div class="profile-card text-center">
                <div class="profile-avatar" id="profile-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <h2 id="user-name">Loading...</h2>
                <p id="user-email" class="mb-2">Loading...</p>
                <div id="account-type-badge"></div>
            </div>

            <div class="row">
                <!-- Usage Statistics -->
                <div class="col-md-8">
                    <div class="stats-card">
                        <h4 class="mb-4"><i class="fas fa-chart-bar"></i> Usage Statistics</h4>
                        
                        <div class="row text-center mb-4">
                            <div class="col-md-4">
                                <div class="stat-icon"><i class="fas fa-calendar-day"></i></div>
                                <div class="stat-number" id="today-usage">-</div>
                                <div class="text-muted">Today's Usage</div>
                            </div>
                            <div class="col-md-4">
                                <div class="stat-icon"><i class="fas fa-bolt"></i></div>
                                <div class="stat-number" id="remaining-uses">-</div>
                                <div class="text-muted">Remaining Today</div>
                            </div>
                            <div class="col-md-4">
                                <div class="stat-icon"><i class="fas fa-calendar-week"></i></div>
                                <div class="stat-number" id="weekly-usage">-</div>
                                <div class="text-muted">This Week</div>
                            </div>
                        </div>

                        <!-- Usage Progress Bar -->
                        <div class="mb-3">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span>Daily Limit Progress</span>
                                <span id="usage-percentage">0%</span>
                            </div>
                            <div class="progress">
                                <div class="progress-bar" id="usage-progress" role="progressbar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="stats-card">
                        <h4 class="mb-3"><i class="fas fa-history"></i> Recent Activity</h4>
                        <div class="usage-history" id="usage-history">
                            <div class="text-center text-muted py-3">
                                <i class="fas fa-spinner fa-spin"></i> Loading activity...
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Account Information -->
                <div class="col-md-4">
                    <div class="stats-card">
                        <h4 class="mb-3"><i class="fas fa-user-cog"></i> Account Info</h4>
                        
                        <div class="mb-3">
                            <strong>User ID:</strong>
                            <p class="text-muted small" id="user-id">Loading...</p>
                        </div>
                        
                        <div class="mb-3">
                            <strong>Account Type:</strong>
                            <p id="account-type-text">Loading...</p>
                        </div>
                        
                        <div class="mb-3">
                            <strong>Daily Limit:</strong>
                            <p id="daily-limit">Loading...</p>
                        </div>
                        
                        <div class="mb-3">
                            <strong>Login Status:</strong>
                            <p class="text-success"><i class="fas fa-check-circle"></i> Authenticated</p>
                        </div>

                        <div class="mb-3">
                            <strong>Session Info:</strong>
                            <p class="text-muted small" id="session-info">Loading...</p>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="stats-card">
                        <h4 class="mb-3"><i class="fas fa-tools"></i> Quick Actions</h4>
                        
                        <div class="d-grid gap-2">
                            <button class="btn btn-primary" onclick="refreshUsageData()">
                                <i class="fas fa-sync-alt"></i> Refresh Data
                            </button>
                            
                            <button class="btn btn-outline-secondary" onclick="clearLocalData()">
                                <i class="fas fa-trash-alt"></i> Clear Local Data
                            </button>
                            
                            <button class="btn btn-info" onclick="exportUsageData()">
                                <i class="fas fa-download"></i> Export Usage Data
                            </button>
                            
                            <a href="./index.html" class="btn btn-success">
                                <i class="fas fa-search"></i> Generate Preferences
                            </a>

                            <a href="https://nextstepedu.co.in" class="btn btn-outline-primary">
                                <i class="fas fa-home"></i> NextStep Home
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Debug Information (can be hidden in production) -->
            <div class="stats-card mt-4" id="debug-info" style="display: none;">
                <h4 class="mb-3"><i class="fas fa-bug"></i> Debug Information</h4>
                <div class="row">
                    <div class="col-md-6">
                        <h6>Authentication State:</h6>
                        <pre id="auth-debug" class="bg-light p-2 small"></pre>
                    </div>
                    <div class="col-md-6">
                        <h6>Usage State:</h6>
                        <pre id="usage-debug" class="bg-light p-2 small"></pre>
                    </div>
                </div>
                <button class="btn btn-sm btn-secondary" onclick="toggleDebugInfo()">
                    <i class="fas fa-eye-slash"></i> Hide Debug Info
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

    <!-- Profile-specific JavaScript -->
    <script>
        // Profile data management
        const ProfileManager = {
            user: null,
            usageData: {},
            debugMode: false,
            
            async init() {
                console.log('Initializing Profile Manager...');
                
                // Enable debug mode if URL contains debug parameter
                const urlParams = new URLSearchParams(window.location.search);
                this.debugMode = urlParams.has('debug');
                if (this.debugMode) {
                    document.getElementById('debug-info').style.display = 'block';
                }
                
                // Wait for authentication to be ready
                if (!window.AuthVerification || !window.AuthVerification.isAuthenticated()) {
                    console.log('User not authenticated, showing error');
                    this.showAuthError();
                    return false;
                }
                
                this.user = window.AuthVerification.user;
                console.log('User authenticated:', this.user);
                
                // Update debug info
                this.updateDebugInfo();
                
                // Load profile data
                await this.loadProfileData();
                await this.loadUsageData();
                
                return true;
            },
            
            async loadProfileData() {
                if (!this.user) return;
                
                // Set user name (extract from email)
                const userName = this.user.email.split('@')[0];
                document.getElementById('user-name').textContent = userName.charAt(0).toUpperCase() + userName.slice(1);
                document.getElementById('user-email').textContent = this.user.email;
                document.getElementById('user-id').textContent = this.user.uid;
                
                // Set profile avatar initial
                const avatarElement = document.getElementById('profile-avatar');
                avatarElement.innerHTML = userName.charAt(0).toUpperCase();
                
                // Session info
                const sessionInfo = document.getElementById('session-info');
                const loginTime = sessionStorage.getItem('loginTime') || 'Unknown';
                sessionInfo.textContent = `Logged in: ${new Date(loginTime).toLocaleString() || 'Session active'}`;
                
                // Check account type
                const isUnlimited = window.UsageLimiter && 
                    window.UsageLimiter.UNLIMITED_EMAILS.includes(this.user.email);
                
                this.setAccountType(isUnlimited);
            },
            
            setAccountType(isUnlimited) {
                const badge = document.getElementById('account-type-badge');
                const typeText = document.getElementById('account-type-text');
                const dailyLimit = document.getElementById('daily-limit');
                
                if (isUnlimited) {
                    badge.innerHTML = '<span class="account-badge unlimited-account"><i class="fas fa-crown"></i> Premium Account</span>';
                    typeText.innerHTML = '<span class="text-success"><i class="fas fa-star"></i> Premium (Unlimited)</span>';
                    dailyLimit.innerHTML = '<span class="text-success">Unlimited</span>';
                } else {
                    badge.innerHTML = '<span class="account-badge limited-account"><i class="fas fa-user"></i> Standard Account</span>';
                    typeText.innerHTML = '<span class="text-warning"><i class="fas fa-user"></i> Standard (Limited)</span>';
                    dailyLimit.innerHTML = `<span class="text-muted">${window.UsageLimiter?.DAILY_LIMIT || 5} generations per day</span>`;
                }
            },
            
            async loadUsageData() {
                try {
                    // Get usage information
                    let usageInfo = { remainingUses: 0, usage: 0 };
                    
                    if (window.FirestoreUsageTracker) {
                        usageInfo = await window.FirestoreUsageTracker.checkAndUpdateUsage(false);
                    } else if (window.UsageLimiter) {
                        usageInfo = await window.UsageLimiter.checkAndUpdateUsage(false);
                    }
                    
                    console.log('Usage info:', usageInfo);
                    
                    // Update UI
                    this.updateUsageDisplay(usageInfo);
                    this.loadUsageHistory();
                    this.updateDebugInfo();
                    
                } catch (error) {
                    console.error('Error loading usage data:', error);
                    this.showUsageError();
                }
            },
            
            updateUsageDisplay(usageInfo) {
                const todayUsage = usageInfo.usage || 0;
                const remainingUses = usageInfo.remainingUses === Infinity ? 'âˆž' : (usageInfo.remainingUses || 0);
                const dailyLimit = window.UsageLimiter?.DAILY_LIMIT || 5;
                
                document.getElementById('today-usage').textContent = todayUsage;
                document.getElementById('remaining-uses').textContent = remainingUses;
                
                // Calculate weekly usage
                const weeklyUsage = this.calculateWeeklyUsage();
                document.getElementById('weekly-usage').textContent = weeklyUsage;
                
                // Calculate and show progress
                if (usageInfo.remainingUses !== Infinity) {
                    const percentage = Math.min((todayUsage / dailyLimit) * 100, 100);
                    document.getElementById('usage-percentage').textContent = `${Math.round(percentage)}%`;
                    
                    const progressBar = document.getElementById('usage-progress');
                    progressBar.style.width = `${percentage}%`;
                    
                    // Color code the progress bar
                    progressBar.className = 'progress-bar';
                    if (percentage >= 80) {
                        progressBar.classList.add('bg-danger');
                    } else if (percentage >= 60) {
                        progressBar.classList.add('bg-warning');
                    } else {
                        progressBar.classList.add('bg-success');
                    }
                } else {
                    document.getElementById('usage-percentage').textContent = 'Unlimited';
                    document.getElementById('usage-progress').style.width = '100%';
                    document.getElementById('usage-progress').classList.add('bg-success');
                }
            },
            
            calculateWeeklyUsage() {
                if (!this.user) return 0;
                
                let weeklyTotal = 0;
                const today = new Date();
                
                for (let i = 0; i < 7; i++) {
                    const date = new Date(today);
                    date.setDate(today.getDate() - i);
                    const dateStr = date.toISOString().split('T')[0];
                    const storageKey = `josaa_usage_${this.user.uid}_${dateStr}`;
                    weeklyTotal += parseInt(localStorage.getItem(storageKey) || '0');
                }
                
                return weeklyTotal;
            },
            
            loadUsageHistory() {
                const historyContainer = document.getElementById('usage-history');
                
                try {
                    // Try to load usage history from localStorage
                    const history = this.getUsageHistory();
                    
                    if (history.length === 0) {
                        historyContainer.innerHTML = `
                            <div class="text-center text-muted py-3">
                                <i class="fas fa-info-circle"></i> No usage history available
                            </div>
                        `;
                    } else {
                        historyContainer.innerHTML = history.map(day => `
                            <div class="usage-day">
                                <span>${day.date}</span>
                                <span class="badge ${day.count > 0 ? 'bg-primary' : 'bg-light text-dark'}">${day.count} generations</span>
                            </div>
                        `).join('');
                    }
                } catch (error) {
                    console.error('Error loading usage history:', error);
                    historyContainer.innerHTML = `
                        <div class="text-center text-muted py-3">
                            <i class="fas fa-exclamation-triangle"></i> Error loading history
                        </div>
                    `;
                }
            },
            
            getUsageHistory() {
                if (!this.user) return [];
                
                const history = [];
                const today = new Date();
                
                // Get last 7 days of usage from localStorage
                for (let i = 0; i < 7; i++) {
                    const date = new Date(today);
                    date.setDate(today.getDate() - i);
                    const dateStr = date.toISOString().split('T')[0];
                    const storageKey = `josaa_usage_${this.user.uid}_${dateStr}`;
                    
                    const usage = parseInt(localStorage.getItem(storageKey) || '0');
                    
                    history.push({
                        date: date.toLocaleDateString('en-US', { 
                            weekday: 'short', 
                            month: 'short', 
                            day: 'numeric' 
                        }),
                        count: usage,
                        dateObj: date
                    });
                }
                
                return history;
            },
            
            updateDebugInfo() {
                if (!this.debugMode) return;
                
                const authDebug = document.getElementById('auth-debug');
                const usageDebug = document.getElementById('usage-debug');
                
                if (authDebug) {
                    authDebug.textContent = JSON.stringify({
                        authenticated: window.AuthVerification?.isAuthenticated(),
                        user: this.user ? {
                            uid: this.user.uid,
                            email: this.user.email
                        } : null,
                        sessionStorage: {
                            authToken: !!sessionStorage.getItem('josaa_auth_token'),
                            authVerified: localStorage.getItem('authVerified')
                        }
                    }, null, 2);
                }
                
                if (usageDebug) {
                    const todayKey = `josaa_usage_${this.user?.uid}_${new Date().toISOString().split('T')[0]}`;
                    usageDebug.textContent = JSON.stringify({
                        todayUsage: localStorage.getItem(todayKey),
                        dailyLimit: window.UsageLimiter?.DAILY_LIMIT,
                        unlimitedEmails: window.UsageLimiter?.UNLIMITED_EMAILS,
                        localStorageKeys: Object.keys(localStorage).filter(key => key.startsWith('josaa_'))
                    }, null, 2);
                }
            },
            
            showAuthError() {
                document.getElementById('auth-loading').style.display = 'none';
                document.getElementById('auth-error-container').style.display = 'block';
                document.getElementById('auth-error-container').innerHTML = `
                    <h2>Authentication Required</h2>
                    <p>Please log in through the <a href="https://nextstepedu.co.in">NextStep</a> website to view your profile.</p>
                    <p class="text-muted">If you were redirected here, please try accessing the main application first:</p>
                    <div class="mt-3">
                        <a href="./index.html" class="btn btn-primary me-2">Go to Generator</a>
                        <a href="https://nextstepedu.co.in" class="btn btn-outline-primary">NextStep Home</a>
                    </div>
                `;
            },
            
            showUsageError() {
                document.getElementById('today-usage').textContent = 'Error';
                document.getElementById('remaining-uses').textContent = 'Error';
                document.getElementById('weekly-usage').textContent = 'Error';
            }
        };
        
        // Global functions for buttons
        window.refreshUsageData = async function() {
            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Refreshing...';
            button.disabled = true;
            
            try {
                await ProfileManager.loadUsageData();
                
                // Show success message
                const alertContainer = document.getElementById('error-alert-container');
                alertContainer.innerHTML = `
                    <div class="alert alert-success alert-dismissible fade show" role="alert">
                        <i class="fas fa-check"></i> Profile data refreshed successfully!
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                `;
            } catch (error) {
                console.error('Error refreshing data:', error);
                const alertContainer = document.getElementById('error-alert-container');
                alertContainer.innerHTML = `
                    <div class="alert alert-danger alert-dismissible fade show" role="alert">
                        <i class="fas fa-exclamation-triangle"></i> Error refreshing data. Please try again.
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                `;
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        };
        
        window.clearLocalData = function() {
            if (confirm('Are you sure you want to clear your local usage data? This action cannot be undone.')) {
                try {
                    // Clear usage-related localStorage items
                    Object.keys(localStorage).forEach(key => {
                        if (key.startsWith('josaa_usage_') || key.startsWith('devUsageCount')) {
                            localStorage.removeItem(key);
                        }
                    });
                    
                    // Reload usage data
                    ProfileManager.loadUsageData();
                    
                    const alertContainer = document.getElementById('error-alert-container');
                    alertContainer.innerHTML = `
                        <div class="alert alert-info alert-dismissible fade show" role="alert">
                            <i class="fas fa-info"></i> Local usage data cleared successfully!
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                        </div>
                    `;
                } catch (error) {
                    console.error('Error clearing data:', error);
                    alert('Error clearing data. Please try again.');
                }
            }
        };

        window.exportUsageData = function() {
            try {
                const usageData = ProfileManager.getUsageHistory();
                const csvContent = "data:text/csv;charset=utf-8," 
                    + "Date,Usage Count\n"
                    + usageData.map(day => `${day.date},${day.count}`).join("\n");
                
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", `usage_history_${new Date().toISOString().split('T')[0]}.csv`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                const alertContainer = document.getElementById('error-alert-container');
                alertContainer.innerHTML = `
                    <div class="alert alert-success alert-dismissible fade show" role="alert">
                        <i class="fas fa-download"></i> Usage data exported successfully!
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                `;
            } catch (error) {
                console.error('Error exporting data:', error);
                alert('Error exporting data. Please try again.');
            }
        };

        window.toggleDebugInfo = function() {
            const debugInfo = document.getElementById('debug-info');
            const button = event.target;
            
            if (debugInfo.style.display === 'none') {
                debugInfo.style.display = 'block';
                button.innerHTML = '<i class="fas fa-eye-slash"></i> Hide Debug Info';
                ProfileManager.debugMode = true;
                ProfileManager.updateDebugInfo();
            } else {
                debugInfo.style.display = 'none';
                button.innerHTML = '<i class="fas fa-eye"></i> Show Debug Info';
                ProfileManager.debugMode = false;
            }
        };

        // Initialize app - this will be called only after auth verification succeeds
        window.initializeApp = async function() {
            console.log('Profile app initialized after successful authentication');
            
            // Store login time
            if (!sessionStorage.getItem('loginTime')) {
                sessionStorage.setItem('loginTime', new Date().toISOString());
            }
            
            // Hide loading overlay
            document.getElementById('auth-loading').style.display = 'none';
            
            // Show main content
            document.getElementById('main-content').style.display = 'block';
            
            // Initialize profile manager
            const success = await ProfileManager.init();
            
            if (success) {
                console.log('Profile loaded successfully');
            } else {
                console.error('Failed to load profile');
            }
        };
        
        // Function to stop all processes if authentication fails
        window.stopAllProcesses = function() {
            console.log('Stopping all processes due to authentication failure');
            ProfileManager.showAuthError();
        };

        // Add debug parameter functionality
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.has('debug')) {
                document.getElementById('debug-info').style.display = 'block';
            }
        });
    </script>

    <!-- Authentication verification script -->
    <script type="module" src="./static/js/auth-verification.js"></script>

    <!-- Usage limiter scripts -->
    <script type="module" src="./static/js/usage-limiter.js"></script>
    <script type="module" src="./static/js/firestore-usage-tracker.js"></script>
</body>
</html>
